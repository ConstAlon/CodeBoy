<style>
	div{
		font-famliy:”楷体“;
	}
</style>

<div>

## 操作系统学习笔记(一)

1. [操作系统概述](#操作系统概述)
	1. [操作系统](#操作系统)
	2. [操作系统的特征](#操作系统的特征)
2. [操作系统的发展与分类](#操作系统的发展与分类)
	1. [手工操作阶段](#手工操作阶段)
	2. [批处理阶段](#批处理阶段)
3. [ 操作系统的运行机制](#操作系统的运行机制)
	1. [预备](#预备)
	2. [内核程序与应用程序](#内核程序与应用程序)
	3. [特权指令与非特权指令](#特权指令与非特权指令)
4. [中断和异常](#中断和异常)
	1. [中断的作用](#中断的作用)
	2. [中断的类型](#中断的类型)
	3. [中断机制的基本原理](#中断机制的基本原理)
5. [系统调用](#系统调用)
	1. [什么是系统调用？](#什么是系统调用？)
	2. [那些功能需要用到系统调用？](#那些功能需要用到系统调用？)
	3. [系统调用的过程](#系统调用的过程)
6. [操作系统的体系结构](#操作系统的体系结构)
	1. [大内核](#大内核)
	2. [微内核](#微内核)
	
## 操作系统概述
##### 操作系统
> 是值控制和管理整个计算机系统的硬件和软件资源，并合理地组织调度计算机的工作和资源的分配，是系统资源的管理者；以提供给用户和其他软件方便的接口和环境；它是计算机系统中最基本的系统软件，最接近硬件的一种软件。

> <font color=red >**补充：执行一个程序前需要将该程序放到内存中，才能被CPU处理**</font>

操作系统还会提供GUI（Graphical User Interface）图形化用户接口，命令接口。***这是直接给用户使用的。*** 
> 命令接口分为 交互式命令接口，脱机命令接口（批处理命令接口）
> 交互式命令接口   例如Windows中的dos命令。
> 程序接口：可以在程序中进行系统调用来使用程序接口。<font color=red>普通用户是不能直接使用程序接口的，只能通过程序代码间接使用。</font>***是给程序或者程序员使用的。***

##### 操作系统的特征
> 1. 并发：值两个或多个事件在同一时间间隔内发生。这些事件宏观上是同时发生的，但是微观上是交替发生的。<font color=red>并发性是操作系统一个最基本的特性</font>
	>>操作系统的并发性：计算机系统中“同时”运行着多个程序，这些程序宏观上是同时运行着，而微观上是交替运行的。
	>><font color=red>操作系统就是伴随着“多道程序技术”而出现的。因此，***操作系统和程序并发是一起诞生的。***</font>
>
2. 并行：值两个或多个时间在同一时刻同时发生。
>
>补充：
>单核CPU同一时刻只能执行一个程序，各个程序只能并发的执行。
>多核CPU同一时刻可以同时执行多个程序，多个程序可以并发的执行。

> 3. 共享：即资源共享，指系统中的资源可供内存中多个并发执行的进程同时使用。
>> 互斥共享方式：系统中某些资源，虽然可以提供给多个进程使用，但一个时间段内只允许一个进程访问该资源。例如：使用QQ或者微信进行视频。
>> 同时共享：系统中某些资源，允许一个时间段内由多个进程“同时”对他们进行访问。例如：使用不同软件进行文件传输。
> 4.  并发和共享的关系
>> <font color=red>共享和并发是互为存在条件</font>
> 5. 虚拟
> 
>> 把一个物理上的实体变为若干个逻辑上的对应物。物理实体是实际存在的，而逻辑上对应物是用户感受到的。
>
>> 虚拟技术 ：
>> >空分复用技术（虚拟存储器技术）
>> >  - - -
>> >时分复用技术（虚拟处理器）
>
> <font color=red>补充：没有并发性，就谈不上虚拟性。</font>
>
> 6. 异步
> > 在多道程序环境下，允许多个程序并发执行，但由于资源有限，进程的执行不是一贯倒地，而是断断续续，以不可预知的速度进行。 


## 操作系统的发展与分类

##### 手工操作阶段
>是由人工将程序写在一条纸袋，使用的方式是打孔，有孔的地方是二进制1，无孔则是0；写好后放入纸带机中，计算机在从纸带机当中读取运行程序，运行完成后，将结果打在纸带上。<font color=red>速度特别慢，而且每个人的程序运行，需要排队放入纸带机中。</font>

##### 批处理阶段
1. 单道批处理系统
> 引入脱机输入/输出技术，并由监督程序负责控制作业的输入、输出。 
> <font color=red>缓解了一定程度的人机速度矛盾，对利用率有所提升。
> 缺点：内存中仅能有一道程序运行，CPU有大量时间是在空闲等待I/O完成。</font>
2. 多道批处理系统（操作系统正式诞生，用于支持多道程序并发运行）
> 与单道一样的处理方式，不同的是：每次往内存中读入多道程序。
> <font color=red>优点： 多道程序并发执行、共享计算机资源。资源利用率大幅提升。
>- - -
> 缺点：用户响应时间长，没有人机交互功能。 
> </font>
3. 分时操作系统
> 计算机以时间片为单位轮流为各个用户/作业服务。
> <font color=red>
> 优点：用户请求可以被即使响应，解决了人机问题。
> - - -
> 缺点：不能优先处理一些紧急任务。对每个用户绝对公平。
> </font>
4. 实时操作系统
>  <font color=red>优点：能够优先响应一些紧急任务，某些紧急任务不需要时间片排队。</font>
>  在实时操作系统的控制下，计算机系统接收到外部信号后及时进行处理，并要在严格的时限内处理完事件。
>  <font color=#00ffffa>主要特点：及时性、可靠性</font>

   1. 硬实时系统
	   > 必须在绝对严格的规定时间内完成处理
	   > 例如：导弹控制系统、自动驾驶系统
	2. 软实时系统
		> 能接受偶尔违反时间规定
		> 例如：订票系统
5. 其他操作系统
	1. 网络操作系统
	2. 分布式操作系统
	3. 个人计算机操作系统

## 操作系统的运行机制
##### 预备

 ###### 程序是怎么运行的

> 程序代码通过编译器生成机器指令(二进制)
> 程序运行的过程就是CPU执行一条条机器指令的过程
> <font color=red>"指令" 就是处理器能识别、执行的最基本命令</font>

 ##### 内核程序 与应用程序
 
>应用程序：普通程序员所编写的。
>内核程序：有一些人专门负责实现操作系统，就属于“内核程序”。
>补充：<font color=red>内核是操作系统最重要、最核心的部分，也是最接近硬件的部分。</font>

##### 特权指令与非特权指令

> 普通程序就是非特权指令
> 操作系统中的程序则就是特权指令

Q: CPU怎么区分特权和非特权？
>CPU有两种状态，“内核态”和“用户态”
>处于内核态，说明正在运行的是内核程序，此时可以执行特权指令
>处于用户态，说明正在运行的是应用程序，此时只能执行非特权指令
>补充：CPU中由一个寄存器：程序状态字寄存器（PSW），“1”表示“内核态，”0“表示”用户态“。
>别名：内核态=核心态=管态；用户态=目胎


Q:CPU怎么切换这两个状态？
> 如果操作系统想要运行某个程序，则会执行一条特权指令改变PSW的标志位，使得状态切换为”用户态“。
> 如果遇到非法指令时，会发生中断，会使得PSW标志位再次改变，变为”内核态“。

## 中断和异常

##### 中断的作用
> 是让操作系统内核夺回CPU使用权的唯一途径。

##### 中断的类型
	
1. 内中断
	
> 与当前执行的指令有关，中断信号来源于CPU内部
  

2. 外中断

> 与当前执行的指令无关，中断信号来源于CPU外部

	
##### 中断机制的基本原理
> 不同的中断信号，需要用不同的中断处理程序来处理。
> 会检查中断信号表
	
	
## 系统调用
	
##### 什么是系统调用？
	
> 是操作系统提供给应用程序使用的接口，可以理解为一种可供应用程序调用的特殊函数，<font color=red>应用程序可以通过调用来请求获取操作系统内核的服务。</font>

##### 那些功能需要用到系统调用？

1. 设备管理
2. 文件管理
3. 进程控制
4. 进程通信
5. 内存管理
	
> 应用程序通过系统调用请求操作系统的服务，而系统中的各种共享资源都由系统内核统一管理，因此<font color=red>凡是与共享资源有关的操作，都必须通过系统调用的方式向操作系统内核提出服务请求，由操作系统内核代为完成。这样可以保证系统的稳定性和安全性，防止用户进行非法操作</font>
	
##### 系统调用的过程

传递系统调用参数 ---> 执行陷入指令（用户态） ---> 执行相应的请求内核程序处理调用（核心态）---> 返回应用程序
	
> 注意：
>  1. 陷入指令是在用户态执行的，执行陷入指令之后立即引发一个内中断，使CPU进入核心态。
> 2. 发出系统调用请求是在用户态，而对系统调用的相应处理是在核心态下进行。
> 
> 注意别名：陷入指令 = trap指令 = 访管指令
	

## 操作系统的体系结构

> 内核是操作系统最基本、最核心的部分。
> 实现操作系统内核功能的那些程序就是内核程序。

##### 大内核

> 把所有功能都包含在操作系统中的称为大内核。
> 只需要两次状态变换。

例如：linux，Unix

##### 微内核

> 内核中只保留与硬件关系紧密的部分称为微内核。
> 需要切换六次状态。

例如：Windows NT

<font color=red>**注意：状态切换的过程是有成本的，是需要消耗不少时间，频繁地切换会使系统性能降低。**</font>
	
</div>
	
